import{r as y,g as h,p as z,c as d,a as v,u as w,m as N,w as C,b as e,l as F,e as k,t as o,z as m,G as c,B as L,o as i,i as D,F as M,k as G,n as V}from"./app-C42XF4l0.js";import{_ as R}from"./MarkerLayout-ChJ5QZTM.js";import"./DropdownLink-C3nCCoGM.js";const T={class:"space-y-6"},I={class:"flex items-start justify-between"},O={class:"text-2xl font-bold text-gray-900"},P={class:"mt-1 flex items-center gap-4 text-sm text-gray-600"},$={class:"inline-flex items-center gap-1"},q={class:"grid gap-4 sm:grid-cols-4"},H={class:"rounded-lg bg-gradient-to-br from-green-50 to-emerald-100 p-4 border-2 border-green-200"},W={class:"mt-1 text-2xl font-bold text-green-900"},J={class:"rounded-lg bg-gradient-to-br from-yellow-50 to-amber-100 p-4 border-2 border-yellow-300"},Q={class:"mt-1 text-2xl font-bold text-green-700"},K={class:"rounded-lg bg-gradient-to-br from-orange-50 to-red-50 p-4 border-2 border-orange-200"},X={class:"mt-1 text-2xl font-bold text-orange-900"},Y={class:"rounded-lg bg-gradient-to-br from-emerald-50 to-teal-100 p-4 border-2 border-emerald-300"},Z={class:"mt-1 text-2xl font-bold text-emerald-900"},ee={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between rounded-lg bg-gray-50 p-4"},te={class:"flex flex-1 items-center gap-3"},se={class:"relative flex-1 max-w-md"},re={class:"flex items-center gap-2"},ae=["disabled"],oe={key:0,class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},le={key:1,class:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none"},ne={class:"rounded-lg bg-white shadow-md overflow-hidden"},de={class:"overflow-x-auto"},ie={class:"min-w-full divide-y divide-gray-200"},ue={class:"divide-y divide-gray-200 bg-white"},me={class:"px-4 py-3 text-sm text-gray-500"},ce={class:"px-4 py-3 text-sm font-medium text-gray-900"},pe={class:"px-4 py-3 text-sm text-gray-900"},xe={class:"px-4 py-3"},ge=["onUpdate:modelValue","onInput","max"],fe={class:"px-4 py-3"},ye=["onUpdate:modelValue"],ke={class:"px-4 py-3"},ve=["onUpdate:modelValue"],be={class:"px-4 py-3"},_e=["onUpdate:modelValue"],he={class:"px-4 py-3 text-center"},we={key:0,class:"inline-flex items-center gap-1 rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-800"},Ce={key:1,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-1 text-xs font-medium text-gray-600"},Me={key:0,class:"text-center py-12"},Se={__name:"EnterMarks",props:{exam:{type:Object,required:!0},candidates:{type:Array,default:()=>[]}},setup(l){const p=l,a=y([]),x=y(""),g=y("all");a.value=p.candidates.map(s=>({candidate_id:s.id,candidate_name:s.full_name,registration_number:s.registration_number,score:s.results?.[0]?.score||null,grade:s.results?.[0]?.grade||"",remarks:s.results?.[0]?.remarks||"",comments:s.results?.[0]?.comments||"",is_marked:!!s.results?.[0]}));const B=(s,t)=>{if(!s||s===""||s===null)return"";const r=s/t*100;return r>=75?"A":r>=65?"B":r>=50?"C":r>=40?"D":r>=30?"E":"F"},j=(s,t)=>{if(!s||s===""||s===null)return"";const r=s/t*100;return r>=75?"Excellent":r>=65?"Very Good":r>=50?"Good":r>=40?"Satisfactory":"Fail"},S=s=>{const t=a.value[s];t.score!==null&&t.score!==""?(t.grade=B(t.score,p.exam.total_marks),t.remarks=j(t.score,p.exam.total_marks),t.is_marked=!0):(t.grade="",t.remarks="",t.is_marked=!1)},b=h(()=>{let s=a.value;if(x.value){const t=x.value.toLowerCase();s=s.filter(r=>r.candidate_name.toLowerCase().includes(t)||r.registration_number.toLowerCase().includes(t))}return g.value==="marked"?s=s.filter(t=>t.is_marked):g.value==="unmarked"&&(s=s.filter(t=>!t.is_marked)),s}),f=h(()=>({total:a.value.length,marked:a.value.filter(s=>s.is_marked).length,unmarked:a.value.filter(s=>!s.is_marked).length,percentage:a.value.length?Math.round(a.value.filter(s=>s.is_marked).length/a.value.length*100):0})),_=z({results:[]}),u=y(!1),U=()=>{const s=a.value.filter(t=>t.score!==null&&t.score!==""&&t.score>=0).map(t=>({candidate_id:t.candidate_id,score:parseInt(t.score),grade:t.grade,remarks:t.remarks,comments:t.comments||null}));if(s.length===0){alert("Please enter marks for at least one candidate before saving.");return}_.results=s,u.value=!0,_.post(route("emas.marker.exams.marks.store",p.exam.id),{preserveScroll:!0,onSuccess:()=>{u.value=!1,a.value.forEach(t=>{t.score!==null&&t.score!==""&&(t.is_marked=!0)})},onError:()=>{u.value=!1}})},A=()=>{confirm("Are you sure you want to clear all marks? This action cannot be undone.")&&a.value.forEach(s=>{s.score=null,s.grade="",s.remarks="",s.comments="",s.is_marked=!1})};return(s,t)=>(i(),d(M,null,[v(w(N),{title:`Enter Marks - ${l.exam.exam_name}`},null,8,["title"]),v(R,null,{default:C(()=>[e("div",T,[e("div",I,[e("div",null,[v(w(F),{href:s.route("emas.marker.dashboard"),class:"inline-flex items-center gap-1 text-sm text-green-600 hover:text-green-700 mb-2"},{default:C(()=>[...t[2]||(t[2]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"})],-1),k(" Back to Dashboard ",-1)])]),_:1},8,["href"]),e("h1",O,o(l.exam.exam_name),1),e("div",P,[e("span",$,[t[3]||(t[3]=e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1)),k(" "+o(l.exam.subject),1)]),e("span",null,o(l.exam.class_form),1),e("span",null,"Total Marks: "+o(l.exam.total_marks),1),e("span",null,"Pass Marks: "+o(l.exam.pass_marks),1)])])]),e("div",q,[e("div",H,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-green-700"},"Jumla ya Wanafunzi",-1)),e("p",W,o(f.value.total),1)]),e("div",J,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-yellow-800"},"Wamewekwa Alama",-1)),e("p",Q,o(f.value.marked),1)]),e("div",K,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-orange-700"},"Hawajakamilika",-1)),e("p",X,o(f.value.unmarked),1)]),e("div",Y,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-emerald-700"},"Maendeleo",-1)),e("p",Z,o(f.value.percentage)+"%",1)])]),e("div",ee,[e("div",te,[e("div",se,[t[8]||(t[8]=e("svg",{class:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>x.value=r),type:"text",placeholder:"Tafuta kwa jina au namba ya usajili...",class:"w-full rounded-lg border border-gray-300 py-2 pl-10 pr-4 text-sm focus:border-green-500 focus:ring-2 focus:ring-green-200"},null,512),[[c,x.value]])]),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>g.value=r),class:"rounded-lg border border-gray-300 py-2 px-4 text-sm focus:border-green-500 focus:ring-2 focus:ring-green-200"},[...t[9]||(t[9]=[e("option",{value:"all"},"All Candidates",-1),e("option",{value:"marked"},"Marked Only",-1),e("option",{value:"unmarked"},"Unmarked Only",-1)])],512),[[L,g.value]])]),e("div",re,[e("button",{onClick:A,type:"button",class:"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Clear All "),e("button",{onClick:U,disabled:u.value,type:"button",class:"inline-flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-semibold text-white hover:bg-green-700 disabled:opacity-50 shadow-md"},[u.value?(i(),d("svg",le,[...t[11]||(t[11]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(i(),d("svg",oe,[...t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)])])),k(" "+o(u.value?"Saving...":"Save Marks"),1)],8,ae)])]),e("div",ne,[e("div",de,[e("table",ie,[t[13]||(t[13]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 w-12"}," # "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Reg. Number "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Candidate Name "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 w-32"}," Score "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 w-20"}," Grade "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 w-32"}," Remarks "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Comments "),e("th",{scope:"col",class:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500 w-24"}," Status ")])],-1)),e("tbody",ue,[(i(!0),d(M,null,G(b.value,(r,E)=>(i(),d("tr",{key:r.candidate_id,class:V({"bg-green-50":r.is_marked})},[e("td",me,o(E+1),1),e("td",ce,o(r.registration_number),1),e("td",pe,o(r.candidate_name),1),e("td",xe,[m(e("input",{"onUpdate:modelValue":n=>r.score=n,onInput:n=>S(a.value.indexOf(r)),type:"number",min:"0",max:l.exam.total_marks,class:"w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm focus:border-green-500 focus:ring-2 focus:ring-green-200",placeholder:"0"},null,40,ge),[[c,r.score,void 0,{number:!0}]])]),e("td",fe,[m(e("input",{"onUpdate:modelValue":n=>r.grade=n,type:"text",readonly:"",class:V(["w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-1.5 text-sm text-center font-bold",{"text-green-700":["A","B"].includes(r.grade),"text-amber-700":["C","D"].includes(r.grade),"text-red-700":["E","F"].includes(r.grade)}])},null,10,ye),[[c,r.grade]])]),e("td",ke,[m(e("input",{"onUpdate:modelValue":n=>r.remarks=n,type:"text",readonly:"",class:"w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-1.5 text-xs"},null,8,ve),[[c,r.remarks]])]),e("td",be,[m(e("input",{"onUpdate:modelValue":n=>r.comments=n,type:"text",class:"w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm focus:border-green-500 focus:ring-2 focus:ring-green-200",placeholder:"Maoni (si lazima)"},null,8,_e),[[c,r.comments]])]),e("td",he,[r.is_marked?(i(),d("span",we,[...t[12]||(t[12]=[e("svg",{class:"h-3 w-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),k(" Marked ",-1)])])):(i(),d("span",Ce," Pending "))])],2))),128))])])]),b.value.length===0?(i(),d("div",Me,[...t[14]||(t[14]=[e("p",{class:"text-sm text-gray-500"},"No candidates found matching your filters.",-1)])])):D("",!0)])])]),_:1})],64))}};export{Se as default};

import{r as u,q as K,G,c as r,a as M,u as F,h as J,w as S,b as e,p as y,s as p,I as Q,D as g,e as f,o,F as c,y as x,t as n,l as U,z as Y,k as T}from"./app-CQgFi69a.js";import{_ as Z}from"./AuthenticatedLayout-q8VnuOAp.js";const ee={class:"space-y-4"},te={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},se={class:"grid w-full grid-cols-1 gap-2 sm:grid-cols-3 sm:gap-3"},le={class:"flex shrink-0 items-center gap-2"},ae={class:"overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm"},re={class:"overflow-x-auto"},oe={class:"min-w-full divide-y divide-gray-200 text-sm"},ne={class:"divide-y divide-gray-100"},de={class:"px-4 py-3 text-gray-900"},ie={class:"px-4 py-3 text-gray-700"},ue={class:"px-4 py-3 text-gray-700"},ce={class:"px-4 py-3"},xe={class:"flex max-w-[240px] flex-wrap gap-1"},me={class:"px-4 py-3"},pe={class:"flex max-w-[240px] flex-wrap gap-1"},ve={class:"px-4 py-3"},ye={class:"flex justify-end gap-2"},ge=["onClick"],fe={key:0},be={class:"flex items-center justify-between border-t bg-gray-50 px-4 py-2 text-sm text-gray-600"},he={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4"},we={class:"w-full max-w-2xl rounded-xl bg-white shadow-lg"},ke={class:"flex items-center justify-between border-b px-5 py-3"},_e={class:"grid gap-4 p-5 sm:grid-cols-2"},je={class:"grid gap-4 p-5 pt-0 sm:grid-cols-2"},Ce=["value"],Me=["value"],Se={class:"flex items-center justify-end gap-2 border-t px-5 py-3"},Ae=["disabled"],Ne={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4"},Ve={class:"w-full max-w-3xl rounded-xl bg-white shadow-lg"},qe={class:"flex items-center justify-between border-b px-5 py-3"},Fe={class:"p-5"},Le={key:0,class:"py-8 text-center text-sm text-gray-500"},Be={class:"grid gap-4 sm:grid-cols-3"},Ue={class:"mt-1 text-base font-semibold text-gray-900"},Te={class:"mt-1 text-sm text-gray-800"},ze={class:"mt-1 text-sm text-gray-800"},De={class:"mt-1 text-sm text-gray-800"},Ee={class:"mt-1 inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},Re={class:"mt-4"},$e={class:"mt-1 flex flex-wrap gap-1"},Oe={key:0,class:"text-xs text-gray-500"},Pe={key:0,class:"mt-2 overflow-hidden rounded-md border border-gray-100"},Xe={class:"min-w-full divide-y divide-gray-200 text-sm"},Ie={class:"divide-y divide-gray-100"},He={class:"px-3 py-2 text-gray-800"},We={class:"mt-4"},Ke={class:"mt-1 flex flex-wrap gap-1"},Ge={key:0,class:"text-xs text-gray-500"},Je={key:0,class:"mt-2 overflow-hidden rounded-md border border-gray-100"},Qe={class:"min-w-full divide-y divide-gray-200 text-sm"},Ye={class:"divide-y divide-gray-100"},Ze={class:"px-3 py-2 text-gray-900"},et={class:"px-3 py-2 text-gray-700"},lt={__name:"Index",props:{teachers:{type:Object,required:!0},filters:{type:Object,default:()=>({q:"",from:"",to:""})}},setup(z){const m=z,w=u(m.filters.q||""),k=u(m.filters.from||""),_=u(m.filters.to||"");function L(){T.get(route("teachers.index"),{q:w.value,from:k.value,to:_.value},{preserveState:!0,replace:!0})}function D(){const a=new URLSearchParams({q:w.value||"",from:k.value||"",to:_.value||"",export:"pdf"}).toString(),t=route("teachers.index")+(route("teachers.index").includes("?")?"&":"?")+a;window.open(t,"_blank")}const b=u(!1),j=u(!1),l=u({name:"",check_no:"",phone:"",email:"",sex:"M",classes:[],subjects:[]}),E=K(()=>l.value.name.trim()!==""&&l.value.check_no.trim()!==""&&l.value.phone.trim()!==""&&(l.value.sex==="M"||l.value.sex==="F")&&l.value.classes.length>0&&l.value.subjects.length>0),A=u([]),h=u([]),v=u([]);async function R(){const a=await fetch(route("classes.search",{q:""}),{headers:{"X-Requested-With":"XMLHttpRequest"}});A.value=a.ok?await a.json():[]}async function $(){if(Array.isArray(h.value)&&h.value.length>0){const t=h.value[0],s=await fetch(route("classes.subjects",{id:t}),{headers:{"X-Requested-With":"XMLHttpRequest"}});if(s.ok){const i=await s.json(),W=Array.isArray(i)?i:Array.isArray(i?.subjects)?i.subjects:[],B=new Map;for(const C of W)C&&C.id!=null&&B.set(C.id,C);v.value=Array.from(B.values())}else v.value=[]}else v.value=[];const a=new Set(v.value.map(t=>t.id));l.value.subjects=(l.value.subjects||[]).filter(t=>a.has(t.id))}function O(){l.value.classes=h.value.slice(0,1).map(a=>({id:a,name:A.value.find(t=>t.id===a)?.name||`#${a}`}))}function P(a){const t=Number(a.target.value||0);h.value=isNaN(t)||t===0?[]:[t],O(),$()}function X(a){const t=Array.from(a.target.selectedOptions).map(i=>Number(i.value)),s=new Map(v.value.map(i=>[i.id,i]));l.value.subjects=t.map(i=>s.get(i)).filter(Boolean)}async function I(){j.value=!0;try{await T.post(route("teachers.store"),{name:l.value.name,check_no:l.value.check_no,phone:l.value.phone,email:l.value.email||null,sex:l.value.sex,class_ids:l.value.classes.map(a=>a.id),subject_ids:l.value.subjects.map(a=>a.id)},{preserveState:!1}),b.value=!1,l.value={name:"",check_no:"",phone:"",email:"",sex:"M",classes:[],subjects:[]}}finally{j.value=!1}}G(b,a=>{a&&(R(),h.value=[],l.value.classes=[],v.value=[],l.value.subjects=[])});const N=u(!1),V=u(!1),d=u(null);async function H(a){N.value=!0,V.value=!0;try{const t=await fetch(route("teachers.show.json",{id:a.id}),{headers:{"X-Requested-With":"XMLHttpRequest"}});d.value=t.ok?await t.json():a}finally{V.value=!1}}function q(a){return a?.name||""}return(a,t)=>(o(),r(c,null,[M(F(J),{title:"Teachers"}),M(Z,null,{header:S(()=>[...t[12]||(t[12]=[e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Teachers")],-1)])]),default:S(()=>[e("div",ee,[e("div",te,[e("div",se,[p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>w.value=s),onKeyup:Q(L,["enter"]),type:"text",placeholder:"Search name / check no / phone",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,544),[[g,w.value]]),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>k.value=s),type:"date",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,k.value]]),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>_.value=s),type:"date",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,_.value]])]),e("div",le,[e("button",{onClick:L,class:"rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50"},"Filter"),e("button",{onClick:D,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"},[...t[13]||(t[13]=[e("svg",{class:"mr-2 h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 5v14m0 0l-4-4m4 4l4-4M4 7v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-3"})],-1),f(" Export PDF ",-1)])]),e("button",{onClick:t[3]||(t[3]=s=>b.value=!0),class:"rounded-md bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-700"},"Add Teacher")])]),e("div",ae,[e("div",re,[e("table",oe,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Name"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Check No"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Phone"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Classes"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Subjects"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Action")])],-1)),e("tbody",ne,[(o(!0),r(c,null,x(m.teachers.data,s=>(o(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",de,n(s.name),1),e("td",ie,n(s.check_no),1),e("td",ue,n(s.phone),1),e("td",ce,[e("div",xe,[(o(!0),r(c,null,x(s.classes||[],i=>(o(),r("span",{key:i.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(i.name),1))),128))])]),e("td",me,[e("div",pe,[(o(!0),r(c,null,x(s.subjects||[],i=>(o(),r("span",{key:i.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(q(i)),1))),128))])]),e("td",ve,[e("div",ye,[M(F(U),{href:a.route("teachers.show",{id:s.id}),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-green-50 text-green-600 ring-1 ring-inset ring-green-200 hover:bg-green-100","aria-label":"Open overview"},{default:S(()=>[...t[14]||(t[14]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"})],-1)])]),_:1},8,["href"]),e("button",{type:"button",onClick:i=>H(s),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-50 text-indigo-600 ring-1 ring-inset ring-indigo-200 hover:bg-indigo-100","aria-label":"View"},[...t[15]||(t[15]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8zm11 3a3 3 0 110-6 3 3 0 010 6z"})],-1)])],8,ge),M(F(U),{as:"button",method:"delete",href:a.route("teachers.destroy",{id:s.id}),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-rose-50 text-rose-600 ring-1 ring-inset ring-rose-200 hover:bg-rose-100","aria-label":"Delete",onclick:"return confirm('Delete this teacher?')"},{default:S(()=>[...t[16]||(t[16]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 7h12M9 7V5a2 2 0 012-2h2a2 2 0 012 2v2m-1 0l-.867 12.142A2 2 0 0114.138 21H9.862a2 2 0 01-1.995-1.858L7 7z"})],-1)])]),_:1},8,["href"])])])]))),128)),m.teachers.data.length===0?(o(),r("tr",fe,[...t[17]||(t[17]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-sm text-gray-500"},"No teachers yet.",-1)])])):y("",!0)])])]),e("div",be,[e("div",null,"Showing "+n(m.teachers.from||0)+"–"+n(m.teachers.to||0)+" of "+n(m.teachers.total),1)])])]),b.value?(o(),r("div",he,[e("div",we,[e("div",ke,[t[20]||(t[20]=e("div",{class:"text-base font-semibold text-gray-800"},"Add Teacher",-1)),e("button",{onClick:t[4]||(t[4]=s=>b.value=!1),class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"Close"},[...t[19]||(t[19]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",_e,[e("div",null,[t[21]||(t[21]=e("label",{class:"text-xs text-gray-500"},[f("Full name "),e("span",{class:"text-rose-600"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.name=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.name]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"text-xs text-gray-500"},[f("Check/Employee No "),e("span",{class:"text-rose-600"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.check_no=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.check_no]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"text-xs text-gray-500"},[f("Phone "),e("span",{class:"text-rose-600"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.phone=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.phone]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"text-xs text-gray-500"},"Email",-1)),p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.value.email=s),type:"email",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.email]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"text-xs text-gray-500"},[f("Sex "),e("span",{class:"text-rose-600"},"*")],-1)),p(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>l.value.sex=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},[...t[25]||(t[25]=[e("option",{value:"M"},"Male",-1),e("option",{value:"F"},"Female",-1)])],512),[[Y,l.value.sex]])])]),e("div",je,[e("div",null,[t[28]||(t[28]=e("label",{class:"text-xs text-gray-500"},[f("Classes "),e("span",{class:"text-rose-600"},"*")],-1)),e("select",{class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",onChange:P},[t[27]||(t[27]=e("option",{value:""},"Select class...",-1)),(o(!0),r(c,null,x(A.value,s=>(o(),r("option",{key:s.id,value:s.id},n(s.name),9,Ce))),128))],32)]),e("div",null,[t[29]||(t[29]=e("label",{class:"text-xs text-gray-500"},[f("Subjects "),e("span",{class:"text-rose-600"},"*")],-1)),e("select",{multiple:"",size:"8",class:"mt-1 w-full rounded-md border border-gray-300 p-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",onChange:X},[(o(!0),r(c,null,x(v.value,s=>(o(),r("option",{key:s.id,value:s.id},n(q(s)),9,Me))),128))],32)])]),e("div",Se,[e("button",{onClick:t[10]||(t[10]=s=>b.value=!1),class:"rounded-md border border-gray-300 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50"},"Cancel"),e("button",{onClick:I,disabled:j.value||!E.value,class:"rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-semibold text-white hover:bg-emerald-700 disabled:opacity-60"},n(j.value?"Saving...":"Save"),9,Ae)])])])):y("",!0),N.value?(o(),r("div",Ne,[e("div",Ve,[e("div",qe,[t[31]||(t[31]=e("div",{class:"text-base font-semibold text-gray-800"},"Teacher Details",-1)),e("button",{onClick:t[11]||(t[11]=s=>N.value=!1),class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"Close"},[...t[30]||(t[30]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Fe,[V.value?(o(),r("div",Le,"Loading...")):(o(),r(c,{key:1},[e("div",Be,[e("div",null,[t[32]||(t[32]=e("div",{class:"text-xs text-gray-500"},"Full name",-1)),e("div",Ue,n(d.value?.name),1),t[33]||(t[33]=e("div",{class:"text-xs text-gray-500"},"Check No",-1)),e("div",Te,n(d.value?.check_no),1)]),e("div",null,[t[34]||(t[34]=e("div",{class:"text-xs text-gray-500"},"Phone",-1)),e("div",ze,n(d.value?.phone),1),t[35]||(t[35]=e("div",{class:"text-xs text-gray-500"},"Email",-1)),e("div",De,n(d.value?.email||"—"),1)]),e("div",null,[t[36]||(t[36]=e("div",{class:"text-xs text-gray-500"},"Sex",-1)),e("div",Ee,n(d.value?.sex),1)])]),e("div",Re,[t[38]||(t[38]=e("div",{class:"text-sm font-semibold text-gray-800"},"Assigned classes",-1)),e("div",$e,[(o(!0),r(c,null,x(d.value?.classes||[],s=>(o(),r("span",{key:s.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(s.name),1))),128)),!d.value?.classes||d.value.classes.length===0?(o(),r("span",Oe,"No classes")):y("",!0)]),d.value?.classes&&d.value.classes.length?(o(),r("div",Pe,[e("table",Xe,[t[37]||(t[37]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left font-semibold text-gray-700"},"Class")])],-1)),e("tbody",Ie,[(o(!0),r(c,null,x(d.value.classes,s=>(o(),r("tr",{key:s.id},[e("td",He,n(s.name),1)]))),128))])])])):y("",!0)]),e("div",We,[t[40]||(t[40]=e("div",{class:"text-sm font-semibold text-gray-800"},"Assigned subjects",-1)),e("div",Ke,[(o(!0),r(c,null,x(d.value?.subjects||[],s=>(o(),r("span",{key:s.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(q(s)),1))),128)),!d.value?.subjects||d.value.subjects.length===0?(o(),r("span",Ge,"No subjects")):y("",!0)]),d.value?.subjects&&d.value.subjects.length?(o(),r("div",Je,[e("table",Qe,[t[39]||(t[39]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left font-semibold text-gray-700"},"Code"),e("th",{class:"px-3 py-2 text-left font-semibold text-gray-700"},"Name")])],-1)),e("tbody",Ye,[(o(!0),r(c,null,x(d.value.subjects,s=>(o(),r("tr",{key:s.id},[e("td",Ze,n(s.code||"—"),1),e("td",et,n(s.name),1)]))),128))])])])):y("",!0)])],64))])])])):y("",!0)]),_:1})],64))}};export{lt as default};

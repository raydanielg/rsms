import{r as a,q as L,E as O,c as r,a as M,u as T,h as K,w as V,b as e,p,s as m,I as X,D as f,o as l,F as y,y as v,t as i,z as E,l as U,n as P,e as b,v as W,k as z}from"./app-BJQxAt22.js";import{_ as G}from"./AuthenticatedLayout-DmZHm018.js";const J={class:"space-y-4"},Q={class:"rounded-xl border border-gray-100 bg-white p-4 shadow-sm"},Z={class:"grid gap-3 sm:grid-cols-5"},ee={class:"sm:col-span-2"},te=["value"],se={class:"mt-3 flex justify-end gap-2"},re={class:"overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm"},le={class:"overflow-x-auto"},oe={class:"min-w-full divide-y divide-gray-200 text-sm"},ae={class:"divide-y divide-gray-100"},ne={class:"px-4 py-3 text-gray-900"},de={class:"px-4 py-3 text-gray-700"},ie={class:"px-4 py-3 text-gray-700"},ue={class:"px-4 py-3 text-gray-700"},me={class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},xe={class:"px-4 py-3"},ge={class:"flex justify-end gap-2"},ye=["onClick"],pe=["onClick"],fe={key:0},ve={key:0,class:"flex flex-wrap items-center justify-between gap-2"},be={class:"text-xs text-gray-500"},ce={class:"flex flex-wrap gap-1"},we=["disabled","onClick","innerHTML"],ke={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},he={class:"relative z-10 w-full max-w-2xl overflow-hidden rounded-xl bg-white shadow-xl"},Ce={class:"flex items-center justify-between border-b px-5 py-3"},je={class:"grid gap-4 p-5 sm:grid-cols-2"},_e={key:0,class:"mt-1 text-xs text-red-600"},Me=["value"],Ve={class:"sm:col-span-2"},Ee={class:"mb-2 flex items-end justify-between gap-2"},Se={class:"flex-1"},Te={class:"flex gap-2"},$e={class:"flex max-h-60 flex-wrap gap-2 overflow-auto rounded-md border border-gray-200 p-2"},qe=["value"],Le={key:0,class:"px-2 py-1 text-xs text-gray-500"},Ue={class:"flex items-center justify-end gap-2 border-t px-5 py-3"},ze=["disabled"],Fe={__name:"Index",props:{exams:{type:Object,required:!0},filters:{type:Object,default:()=>({})},classes:{type:Array,required:!0},types:{type:Array,required:!0},current_year:{type:Number,required:!0}},setup(u){const x=u,c=a(x.filters.q||""),w=a(x.filters.type||""),k=a(x.filters.year||""),h=a(x.filters.term||"");function C(d=route("results.index")){z.get(d,{q:c.value,type:w.value,year:k.value,term:h.value},{preserveScroll:!0,preserveState:!0,replace:!0})}const g=a(!1),n=a({name:"",type:"midterm",year:x.current_year,term:1,class_ids:[]}),j=a(!1),_=a(""),S=L(()=>{const d=_.value.trim().toLowerCase();return d?x.classes.filter(t=>(t.name||"").toLowerCase().includes(d)):x.classes});function B(){n.value={name:"",type:"midterm",year:x.current_year,term:1,class_ids:[]},_.value="",g.value=!0}async function N(){j.value=!0;try{await z.post(route("results.exams.store"),n.value,{preserveScroll:!0,onSuccess:()=>{g.value=!1,window.__toast&&window.__toast("success","Exam created")},onError:d=>{const t=Object.values(d||{})[0]||"Failed to create";window.__toast&&window.__toast("error",String(t))}})}finally{j.value=!1}}const A=O(),$=L(()=>A.props.errors||{}),F=a(!1),q=a(!1),D=a({id:null,name:"",type:"midterm",year:x.current_year,term:1,class_ids:[]});async function R(d){F.value=!0,q.value=!0;try{const t=d.id,s=await fetch(route("results.exams.show.json",{id:t}),{headers:{"X-Requested-With":"XMLHttpRequest"}}),o=s.ok?await s.json():null;if(!o){window.__toast&&window.__toast("error","Failed to load exam");return}D.value={id:o.id,name:o.name,type:o.type,year:o.year,term:o.term,class_ids:o.class_ids||[]}}finally{q.value=!1}}a(!1);const H=a(!1),Y=a({id:null,name:""});a(!1);function I(d){Y.value={id:d.id,name:d.name},H.value=!0}return(d,t)=>(l(),r(y,null,[M(T(K),{title:"Results"}),M(G,null,{header:V(()=>[e("div",{class:"flex items-center justify-between"},[t[18]||(t[18]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Results",-1)),e("button",{type:"button",onClick:B,class:"rounded-md bg-gradient-to-r from-green-600 to-emerald-600 px-3 py-2 text-sm font-medium text-white shadow hover:from-green-700 hover:to-emerald-700"},"Create Exam")])]),default:V(()=>[e("div",J,[e("div",Q,[e("div",Z,[e("div",ee,[t[19]||(t[19]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},"Search exam",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),onKeyup:t[1]||(t[1]=X(s=>C(),["enter"])),type:"text",placeholder:"e.g. Midterm",class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},null,544),[[f,c.value]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},"Type",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>w.value=s),class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},[t[20]||(t[20]=e("option",{value:""},"All",-1)),(l(!0),r(y,null,v(u.types,s=>(l(),r("option",{key:s,value:s},i(s),9,te))),128))],512),[[E,w.value]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},"Year",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>k.value=s),type:"number",min:"2000",max:"2100",class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},null,512),[[f,k.value]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},"Term",-1)),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>h.value=s),class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},[...t[23]||(t[23]=[e("option",{value:""},"All",-1),e("option",{value:1},"1",-1),e("option",{value:2},"2",-1),e("option",{value:3},"3",-1)])],512),[[E,h.value]])])]),e("div",se,[e("button",{type:"button",onClick:t[5]||(t[5]=()=>{c.value="",w.value="",k.value="",h.value="",C()}),class:"rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"},"Reset"),e("button",{type:"button",onClick:t[6]||(t[6]=s=>C()),class:"rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700"},"Search")])]),e("div",re,[e("div",le,[e("table",oe,[t[30]||(t[30]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Name"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Type"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Year/Term"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Classes"),e("th",{class:"px-4 py-3 text-right font-semibold text-gray-700"},"Action")])],-1)),e("tbody",ae,[(l(!0),r(y,null,v(u.exams.data,s=>(l(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ne,i(s.name),1),e("td",de,i(s.type),1),e("td",ie,i(s.year)+"/T"+i(s.term),1),e("td",ue,[e("span",me,i(s.classes_count)+" classes",1)]),e("td",xe,[e("div",ge,[M(T(U),{href:d.route("marking.show",{examId:s.id}),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-green-50 text-green-600 ring-1 ring-inset ring-green-200 hover:bg-green-100","aria-label":"Mark"},{default:V(()=>[...t[25]||(t[25]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"})],-1)])]),_:1},8,["href"]),M(T(U),{href:d.route("results.exams.show",{id:s.id}),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-50 text-indigo-600 ring-1 ring-inset ring-indigo-200 hover:bg-indigo-100","aria-label":"View"},{default:V(()=>[...t[26]||(t[26]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12s3.75-7.5 9.75-7.5S21.75 12 21.75 12s-3.75 7.5-9.75 7.5S2.25 12 2.25 12z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 15a3 3 0 100-6 3 3 0 000 6z"})],-1)])]),_:1},8,["href"]),e("button",{type:"button",onClick:o=>R(s),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-emerald-50 text-emerald-600 ring-1 ring-inset ring-emerald-200 hover:bg-emerald-100","aria-label":"Edit"},[...t[27]||(t[27]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 3.487a2.1 2.1 0 113 3L8.25 18.1 4.5 19.5l1.4-3.75 10.962-12.263z"})],-1)])],8,ye),e("button",{type:"button",onClick:o=>I(s),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-rose-50 text-rose-600 ring-1 ring-inset ring-rose-200 hover:bg-rose-100","aria-label":"Delete"},[...t[28]||(t[28]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 7h12M9 7V5a2 2 0 012-2h2a2 2 0 012 2v2m-1 0l-.867 12.142A2 2 0 0114.138 21H9.862a2 2 0 01-1.995-1.858L7 7z"})],-1)])],8,pe)])])]))),128)),(u.exams.data||[]).length===0?(l(),r("tr",fe,[...t[29]||(t[29]=[e("td",{colspan:"5",class:"px-4 py-8 text-center text-sm text-gray-500"},"No exams found.",-1)])])):p("",!0)])])])]),u.exams.links?(l(),r("div",ve,[e("div",be,"Showing "+i(u.exams.from||0)+"-"+i(u.exams.to||0)+" of "+i(u.exams.total||0),1),e("div",ce,[(l(!0),r(y,null,v(u.exams.links,(s,o)=>(l(),r("button",{key:o,disabled:!s.url,onClick:Be=>s.url&&C(s.url),class:P(["rounded-md px-3 py-1.5 text-sm",[s.active?"bg-green-600 text-white":"border border-gray-300 text-gray-700 hover:bg-gray-50",s.url?"":"opacity-50"]]),innerHTML:s.label},null,10,we))),128))])])):p("",!0)]),g.value?(l(),r("div",ke,[e("div",{class:"absolute inset-0 bg-black/40",onClick:t[7]||(t[7]=s=>g.value=!1)}),e("div",he,[e("div",Ce,[t[32]||(t[32]=e("h3",{class:"text-base font-semibold text-gray-800"},"Create Exam",-1)),e("button",{onClick:t[8]||(t[8]=s=>g.value=!1),class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"Close"},[...t[31]||(t[31]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",je,[e("div",null,[t[33]||(t[33]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},[b("Exam name "),e("span",{class:"text-red-600"},"*")],-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>n.value.name=s),type:"text",class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},null,512),[[f,n.value.name]]),$.value.name?(l(),r("p",_e,i($.value.name),1)):p("",!0)]),e("div",null,[t[34]||(t[34]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},[b("Type "),e("span",{class:"text-red-600"},"*")],-1)),m(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>n.value.type=s),class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},[(l(!0),r(y,null,v(u.types,s=>(l(),r("option",{key:s,value:s},i(s),9,Me))),128))],512),[[E,n.value.type]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},[b("Year "),e("span",{class:"text-red-600"},"*")],-1)),m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>n.value.year=s),type:"number",min:"2000",max:"2100",class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},null,512),[[f,n.value.year]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},[b("Term "),e("span",{class:"text-red-600"},"*")],-1)),m(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>n.value.term=s),class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},[...t[36]||(t[36]=[e("option",{value:1},"1",-1),e("option",{value:2},"2",-1),e("option",{value:3},"3",-1)])],512),[[E,n.value.term]])]),e("div",Ve,[t[38]||(t[38]=e("label",{class:"mb-1 block text-xs font-medium text-gray-600"},"Assign classes",-1)),e("div",Ee,[e("div",Se,[m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>_.value=s),type:"text",placeholder:"Filter classes...",class:"w-full rounded-md border-gray-300 text-sm shadow-sm focus:border-green-600 focus:ring-green-600"},null,512),[[f,_.value]])]),e("div",Te,[e("button",{type:"button",onClick:t[14]||(t[14]=s=>n.value.class_ids=S.value.map(o=>o.id)),class:"rounded-md border border-gray-300 px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50"},"Select all"),e("button",{type:"button",onClick:t[15]||(t[15]=s=>n.value.class_ids=[]),class:"rounded-md border border-gray-300 px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50"},"Clear")])]),e("div",$e,[(l(!0),r(y,null,v(S.value,s=>(l(),r("label",{key:s.id,class:"flex items-center gap-2 rounded-md bg-gray-50 px-2 py-1 text-sm text-gray-700 ring-1 ring-inset ring-gray-200"},[m(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[16]||(t[16]=o=>n.value.class_ids=o)},null,8,qe),[[W,n.value.class_ids]]),b(" "+i(s.name),1)]))),128)),S.value.length===0?(l(),r("div",Le,"No classes found.")):p("",!0)])])]),e("div",Ue,[e("button",{onClick:t[17]||(t[17]=s=>g.value=!1),type:"button",class:"rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"},"Cancel"),e("button",{disabled:j.value,onClick:N,type:"button",class:"rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 disabled:opacity-60"},i(j.value?"Creating...":"Create Exam"),9,ze)])])])):p("",!0)]),_:1})],64))}};export{Fe as default};

import{r as u,m as Y,B as Z,k as o,a as S,d as $,h as ee,w as T,b as e,l as v,p as m,G as te,D as g,o as a,F as x,x as c,t as n,s as A,f as p,y as se,e as U,n as E,I as le,i as O}from"./app-CqLdGHxU.js";import{_ as oe}from"./AuthenticatedLayout-Ckq8bQj-.js";const ae={class:"flex items-center justify-between"},re={class:"space-y-4"},ne={class:"flex items-center gap-2"},de={class:"overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm"},ie={class:"overflow-x-auto"},ue={class:"min-w-full divide-y divide-gray-200 text-sm"},xe={class:"divide-y divide-gray-100"},ce={class:"px-4 py-3 text-gray-900"},ve={class:"px-4 py-3 text-gray-700"},me={class:"px-4 py-3 text-gray-700"},pe={class:"px-4 py-3"},ge={class:"flex max-w-[240px] flex-wrap gap-1"},ye={class:"px-4 py-3"},fe={class:"flex max-w-[240px] flex-wrap gap-1"},be={class:"px-4 py-3"},he={class:"flex justify-end gap-2"},we=["onClick"],ke={key:0},_e={class:"flex items-center justify-between border-t bg-gray-50 px-4 py-2 text-sm text-gray-600"},je={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4"},Ce={class:"w-full max-w-2xl rounded-xl bg-white shadow-lg"},Me={class:"flex items-center justify-between border-b px-5 py-3"},Se={class:"grid gap-4 p-5 sm:grid-cols-2"},Te={class:"grid gap-4 p-5 pt-0 sm:grid-cols-2"},Ne={class:"mt-1"},Ve=["value","selected"],qe={class:"mt-2 flex flex-wrap gap-1"},Fe=["onClick"],$e={class:"relative"},Be={class:"mt-1 flex items-center gap-2"},Le={class:"absolute z-10 mt-1 w-full max-h-52 overflow-auto rounded-md border border-gray-200 bg-white shadow"},De={class:"sticky top-0 z-10 flex items-center justify-between bg-white/90 px-3 py-1 text-xs text-gray-500"},Ie=["onClick"],ze={class:"flex items-center gap-2"},Ae={key:0,class:"rounded-full bg-indigo-100 px-2 py-0.5 text-[10px] font-medium text-indigo-700"},Ue={key:1,class:"h-4 w-4 text-indigo-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ee={key:0,class:"px-3 py-2 text-xs text-gray-500"},Oe={class:"mt-2 flex flex-wrap gap-1"},Xe=["onClick"],He={class:"flex items-center justify-end gap-2 border-t px-5 py-3"},Re=["disabled"],Pe={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4"},We={class:"w-full max-w-3xl rounded-xl bg-white shadow-lg"},Ke={class:"flex items-center justify-between border-b px-5 py-3"},Qe={class:"p-5"},Ge={key:0,class:"py-8 text-center text-sm text-gray-500"},Je={class:"grid gap-4 sm:grid-cols-3"},Ye={class:"mt-1 text-base font-semibold text-gray-900"},Ze={class:"mt-1 text-sm text-gray-800"},et={class:"mt-1 text-sm text-gray-800"},tt={class:"mt-1 text-sm text-gray-800"},st={class:"mt-1 inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},lt={class:"mt-4"},ot={class:"mt-1 flex flex-wrap gap-1"},at={key:0,class:"text-xs text-gray-500"},rt={key:0,class:"mt-2 overflow-hidden rounded-md border border-gray-100"},nt={class:"min-w-full divide-y divide-gray-200 text-sm"},dt={class:"divide-y divide-gray-100"},it={class:"px-3 py-2 text-gray-800"},ut={class:"mt-4"},xt={class:"mt-1 flex flex-wrap gap-1"},ct={key:0,class:"text-xs text-gray-500"},vt={key:0,class:"mt-2 overflow-hidden rounded-md border border-gray-100"},mt={class:"min-w-full divide-y divide-gray-200 text-sm"},pt={class:"divide-y divide-gray-100"},gt={class:"px-3 py-2 text-gray-900"},yt={class:"px-3 py-2 text-gray-700"},ht={__name:"Index",props:{teachers:{type:Object,required:!0},filters:{type:Object,default:()=>({q:""})}},setup(X){const y=X,N=u(y.filters.q||"");function B(){O.get(route("teachers.index"),{q:N.value},{preserveState:!0,replace:!0})}const f=u(!1),w=u(!1),l=u({name:"",check_no:"",phone:"",email:"",sex:"M",classes:[],subjects:[]}),H=Y(()=>l.value.name.trim()!==""&&l.value.check_no.trim()!==""&&l.value.phone.trim()!==""&&(l.value.sex==="M"||l.value.sex==="F")&&l.value.classes.length>0&&l.value.subjects.length>0),k=u(""),V=u([]),b=u([]),_=u(""),j=u([]),R=u(!1),h=u(!1);let L,D;function I(){clearTimeout(L),L=setTimeout(async()=>{const r=await fetch(route("classes.search",{q:k.value}),{headers:{"X-Requested-With":"XMLHttpRequest"}});V.value=r.ok?await r.json():[]},250)}function C(){clearTimeout(D),D=setTimeout(async()=>{const r=await fetch(route("subjects.search",{q:_.value}),{headers:{"X-Requested-With":"XMLHttpRequest"}});j.value=r.ok?await r.json():[]},250)}function P(r,t){const s=r.value.findIndex(d=>d.id===t.id);s===-1?r.value.push(t):r.value.splice(s,1)}function z(r,t){const s=r.value.findIndex(d=>d.id===t);s!==-1&&r.value.splice(s,1)}function W(){l.value.classes=b.value.map(r=>({id:r,name:V.value.find(t=>t.id===r)?.name||`#${r}`}))}function K(r){const t=Array.from(r.target.selectedOptions).map(s=>Number(s.value));b.value=t,W()}async function Q(){w.value=!0;try{await O.post(route("teachers.store"),{name:l.value.name,check_no:l.value.check_no,phone:l.value.phone,email:l.value.email||null,sex:l.value.sex,class_ids:l.value.classes.map(r=>r.id),subject_ids:l.value.subjects.map(r=>r.id)},{preserveState:!1}),f.value=!1,l.value={name:"",check_no:"",phone:"",email:"",sex:"M",classes:[],subjects:[]}}finally{w.value=!1}}Z(f,r=>{r&&(k.value="",_.value="",I(),C(),R.value=!0,h.value=!0,b.value=[],l.value.classes=[])});const q=u(!1),F=u(!1),i=u(null);async function G(r){q.value=!0,F.value=!0;try{const t=await fetch(route("teachers.show.json",{id:r.id}),{headers:{"X-Requested-With":"XMLHttpRequest"}});i.value=t.ok?await t.json():r}finally{F.value=!1}}function M(r){return r.code||r.name}return(r,t)=>(a(),o(x,null,[S($(ee),{title:"Teachers"}),S(oe,null,{header:T(()=>[e("div",ae,[t[14]||(t[14]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Teachers",-1)),e("button",{onClick:t[0]||(t[0]=s=>f.value=!0),class:"rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-semibold text-white hover:bg-emerald-700"},"Add Teacher")])]),default:T(()=>[e("div",re,[e("div",ne,[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>N.value=s),onKeyup:te(B,["enter"]),type:"text",placeholder:"Search name / check no / phone",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,544),[[g,N.value]]),e("button",{onClick:B,class:"rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50"},"Filter")]),e("div",de,[e("div",ie,[e("table",ue,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Name"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Check No"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Phone"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Classes"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Subjects"),e("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Action")])],-1)),e("tbody",xe,[(a(!0),o(x,null,c(y.teachers.data,s=>(a(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ce,n(s.name),1),e("td",ve,n(s.check_no),1),e("td",me,n(s.phone),1),e("td",pe,[e("div",ge,[(a(!0),o(x,null,c(s.classes||[],d=>(a(),o("span",{key:d.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(d.name),1))),128))])]),e("td",ye,[e("div",fe,[(a(!0),o(x,null,c(s.subjects||[],d=>(a(),o("span",{key:d.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(M(d)),1))),128))])]),e("td",be,[e("div",he,[S($(A),{href:r.route("teachers.show",{id:s.id}),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-green-50 text-green-600 ring-1 ring-inset ring-green-200 hover:bg-green-100","aria-label":"Open overview"},{default:T(()=>[...t[15]||(t[15]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"})],-1)])]),_:1},8,["href"]),e("button",{type:"button",onClick:d=>G(s),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-50 text-indigo-600 ring-1 ring-inset ring-indigo-200 hover:bg-indigo-100","aria-label":"View"},[...t[16]||(t[16]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8zm11 3a3 3 0 110-6 3 3 0 010 6z"})],-1)])],8,we),S($(A),{as:"button",method:"delete",href:r.route("teachers.destroy",{id:s.id}),class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-rose-50 text-rose-600 ring-1 ring-inset ring-rose-200 hover:bg-rose-100","aria-label":"Delete",onclick:"return confirm('Delete this teacher?')"},{default:T(()=>[...t[17]||(t[17]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 7h12M9 7V5a2 2 0 012-2h2a2 2 0 012 2v2m-1 0l-.867 12.142A2 2 0 0114.138 21H9.862a2 2 0 01-1.995-1.858L7 7z"})],-1)])]),_:1},8,["href"])])])]))),128)),y.teachers.data.length===0?(a(),o("tr",ke,[...t[18]||(t[18]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-sm text-gray-500"},"No teachers yet.",-1)])])):v("",!0)])])]),e("div",_e,[e("div",null,"Showing "+n(y.teachers.from||0)+"–"+n(y.teachers.to||0)+" of "+n(y.teachers.total),1)])])]),f.value?(a(),o("div",je,[e("div",Ce,[e("div",Me,[t[21]||(t[21]=e("div",{class:"text-base font-semibold text-gray-800"},"Add Teacher",-1)),e("button",{onClick:t[2]||(t[2]=s=>f.value=!1),class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"Close"},[...t[20]||(t[20]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Se,[e("div",null,[t[22]||(t[22]=e("label",{class:"text-xs text-gray-500"},[p("Full name "),e("span",{class:"text-rose-600"},"*")],-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.name=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.name]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"text-xs text-gray-500"},[p("Check/Employee No "),e("span",{class:"text-rose-600"},"*")],-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.check_no=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.check_no]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"text-xs text-gray-500"},[p("Phone "),e("span",{class:"text-rose-600"},"*")],-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.phone=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.phone]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"text-xs text-gray-500"},"Email",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.email=s),type:"email",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,512),[[g,l.value.email]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"text-xs text-gray-500"},[p("Sex "),e("span",{class:"text-rose-600"},"*")],-1)),m(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.sex=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},[...t[26]||(t[26]=[e("option",{value:"M"},"Male",-1),e("option",{value:"F"},"Female",-1)])],512),[[se,l.value.sex]])])]),e("div",Te,[e("div",null,[t[29]||(t[29]=e("label",{class:"text-xs text-gray-500"},[p("Classes "),e("span",{class:"text-rose-600"},"*")],-1)),e("div",Ne,[m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>k.value=s),onInput:I,placeholder:"Search classes",class:"mb-2 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,544),[[g,k.value]]),e("select",{multiple:"",size:"6",onChange:K,class:"w-full rounded-md border border-gray-300 p-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},[(a(!0),o(x,null,c(V.value,s=>(a(),o("option",{key:s.id,value:s.id,selected:b.value.includes(s.id)},n(s.name)+" (ID: "+n(s.id)+")",9,Ve))),128))],32),t[28]||(t[28]=e("div",{class:"mt-1 text-[11px] text-gray-500"},"Hold Ctrl/Cmd to select multiple.",-1))]),e("div",qe,[(a(!0),o(x,null,c(l.value.classes,s=>(a(),o("span",{key:s.id,class:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-200"},[p(n(s.name)+" (ID: "+n(s.id)+") ",1),e("button",{onClick:U(d=>{z(l.value.classes,s.id),b.value=b.value.filter(J=>J!==s.id)},["stop"]),class:"text-emerald-700/70 hover:text-emerald-900","aria-label":"Remove"},"×",8,Fe)]))),128))])]),e("div",$e,[t[32]||(t[32]=e("label",{class:"text-xs text-gray-500"},[p("Subjects "),e("span",{class:"text-rose-600"},"*")],-1)),e("div",Be,[m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>_.value=s),onFocus:t[10]||(t[10]=s=>{h.value=!0,C()}),onInput:C,placeholder:"Search subjects",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500"},null,544),[[g,_.value]]),e("button",{type:"button",onClick:t[11]||(t[11]=s=>{h.value=!h.value,h.value&&C()}),class:"inline-flex h-9 w-9 items-center justify-center rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50","aria-label":"Toggle subjects"},[...t[30]||(t[30]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])])]),m(e("div",Le,[e("div",De,[e("span",null,"Found "+n(j.value.length),1),e("span",null,"Selected "+n(l.value.subjects.length),1)]),(a(!0),o(x,null,c(j.value,s=>(a(),o("div",{key:s.id,onClick:d=>P(l.value.subjects,s),class:E(["flex cursor-pointer items-center justify-between px-3 py-2 hover:bg-indigo-50",l.value.subjects.some(d=>d.id===s.id)?"bg-indigo-50/60 ring-1 ring-indigo-200":""])},[e("div",{class:E(["text-sm",l.value.subjects.some(d=>d.id===s.id)?"font-semibold text-indigo-700":"text-gray-800"])},n(M(s)),3),e("div",ze,[l.value.subjects.some(d=>d.id===s.id)?(a(),o("span",Ae,"Selected")):v("",!0),l.value.subjects.some(d=>d.id===s.id)?(a(),o("svg",Ue,[...t[31]||(t[31]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)])])):v("",!0)])],10,Ie))),128)),j.value.length===0?(a(),o("div",Ee,"No matches")):v("",!0)],512),[[le,h.value]]),e("div",Oe,[(a(!0),o(x,null,c(l.value.subjects,s=>(a(),o("span",{key:s.id,class:"inline-flex items-center gap-1 rounded-full bg-indigo-50 px-2 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-200"},[p(n(M(s))+" ",1),e("button",{onClick:U(d=>z(l.value.subjects,s.id),["stop"]),class:"text-indigo-700/70 hover:text-indigo-900","aria-label":"Remove"},"×",8,Xe)]))),128))])])]),e("div",He,[e("button",{onClick:t[12]||(t[12]=s=>f.value=!1),class:"rounded-md border border-gray-300 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50"},"Cancel"),e("button",{onClick:Q,disabled:w.value||!H.value,class:"rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-semibold text-white hover:bg-emerald-700 disabled:opacity-60"},n(w.value?"Saving...":"Save"),9,Re)])])])):v("",!0),q.value?(a(),o("div",Pe,[e("div",We,[e("div",Ke,[t[34]||(t[34]=e("div",{class:"text-base font-semibold text-gray-800"},"Teacher Details",-1)),e("button",{onClick:t[13]||(t[13]=s=>q.value=!1),class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"Close"},[...t[33]||(t[33]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Qe,[F.value?(a(),o("div",Ge,"Loading...")):(a(),o(x,{key:1},[e("div",Je,[e("div",null,[t[35]||(t[35]=e("div",{class:"text-xs text-gray-500"},"Full name",-1)),e("div",Ye,n(i.value?.name),1),t[36]||(t[36]=e("div",{class:"text-xs text-gray-500"},"Check No",-1)),e("div",Ze,n(i.value?.check_no),1)]),e("div",null,[t[37]||(t[37]=e("div",{class:"text-xs text-gray-500"},"Phone",-1)),e("div",et,n(i.value?.phone),1),t[38]||(t[38]=e("div",{class:"text-xs text-gray-500"},"Email",-1)),e("div",tt,n(i.value?.email||"—"),1)]),e("div",null,[t[39]||(t[39]=e("div",{class:"text-xs text-gray-500"},"Sex",-1)),e("div",st,n(i.value?.sex),1)])]),e("div",lt,[t[41]||(t[41]=e("div",{class:"text-sm font-semibold text-gray-800"},"Assigned classes",-1)),e("div",ot,[(a(!0),o(x,null,c(i.value?.classes||[],s=>(a(),o("span",{key:s.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(s.name),1))),128)),!i.value?.classes||i.value.classes.length===0?(a(),o("span",at,"No classes")):v("",!0)]),i.value?.classes&&i.value.classes.length?(a(),o("div",rt,[e("table",nt,[t[40]||(t[40]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left font-semibold text-gray-700"},"Class")])],-1)),e("tbody",dt,[(a(!0),o(x,null,c(i.value.classes,s=>(a(),o("tr",{key:s.id},[e("td",it,n(s.name),1)]))),128))])])])):v("",!0)]),e("div",ut,[t[43]||(t[43]=e("div",{class:"text-sm font-semibold text-gray-800"},"Assigned subjects",-1)),e("div",xt,[(a(!0),o(x,null,c(i.value?.subjects||[],s=>(a(),o("span",{key:s.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-700"},n(M(s)),1))),128)),!i.value?.subjects||i.value.subjects.length===0?(a(),o("span",ct,"No subjects")):v("",!0)]),i.value?.subjects&&i.value.subjects.length?(a(),o("div",vt,[e("table",mt,[t[42]||(t[42]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left font-semibold text-gray-700"},"Code"),e("th",{class:"px-3 py-2 text-left font-semibold text-gray-700"},"Name")])],-1)),e("tbody",pt,[(a(!0),o(x,null,c(i.value.subjects,s=>(a(),o("tr",{key:s.id},[e("td",gt,n(s.code||"—"),1),e("td",yt,n(s.name),1)]))),128))])])])):v("",!0)])],64))])])])):v("",!0)]),_:1})],64))}};export{ht as default};

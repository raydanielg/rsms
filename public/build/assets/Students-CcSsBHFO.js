import{r as n,v as q,h as L,c as o,a as R,u as V,m as X,w as j,b as t,i as f,o as a,e as B,t as r,z as v,F as c,k as p,B as _,G as T,n as C,y as z}from"./app-C42XF4l0.js";import{_ as U}from"./AuthenticatedLayout-BqSWkGMK.js";import"./DropdownLink-C3nCCoGM.js";const A={class:"space-y-6"},E={key:0,class:"rounded-md border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800"},H={class:"grid gap-4 sm:grid-cols-3"},D={class:"rounded-xl border border-blue-100 bg-gradient-to-br from-blue-50 to-white p-6 shadow-sm"},P={class:"flex items-center justify-between"},W={class:"mt-2 text-3xl font-bold text-blue-900"},G={class:"rounded-xl border border-green-100 bg-gradient-to-br from-green-50 to-white p-6 shadow-sm"},$={class:"flex items-center justify-between"},I={class:"mt-2 text-3xl font-bold text-green-900"},J={class:"rounded-xl border border-pink-100 bg-gradient-to-br from-pink-50 to-white p-6 shadow-sm"},K={class:"flex items-center justify-between"},O={class:"mt-2 text-3xl font-bold text-pink-900"},Q={class:"rounded-xl border border-gray-200 bg-white p-4 shadow-sm"},Y={class:"grid gap-4 sm:grid-cols-4"},Z=["value"],tt=["value"],et=["value"],st={class:"overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm"},ot={class:"overflow-x-auto"},at={class:"min-w-full divide-y divide-gray-200"},lt={class:"divide-y divide-gray-100 bg-white"},rt={class:"whitespace-nowrap px-6 py-4"},nt={key:0,class:"text-2xl"},dt={key:1,class:"text-2xl"},it={key:2,class:"text-2xl"},ut={key:3,class:"text-sm font-medium text-gray-700"},ct={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},pt={class:"whitespace-nowrap px-6 py-4"},xt={class:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800"},mt={class:"whitespace-nowrap px-6 py-4"},gt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-600"},bt={key:0},yt={class:"overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm"},ft={class:"overflow-x-auto"},vt={class:"min-w-full divide-y divide-gray-200"},ht={class:"divide-y divide-gray-100 bg-white"},wt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},_t={class:"whitespace-nowrap px-6 py-4"},kt={class:"flex items-center gap-2"},St={class:"h-2 w-24 rounded-full bg-gray-200"},Mt={class:"text-sm font-semibold text-gray-700"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm text-green-600 font-medium"},Rt={class:"whitespace-nowrap px-6 py-4 text-sm text-orange-600 font-medium"},jt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-600"},Ct={key:0},zt={class:"overflow-hidden rounded-xl border border-gray-100 bg-white shadow-sm"},Nt={class:"overflow-x-auto"},qt={class:"min-w-full divide-y divide-gray-200 text-sm"},Lt={class:"divide-y divide-gray-100"},Vt={class:"px-6 py-4 text-gray-900 font-medium"},Xt={class:"px-6 py-4 text-gray-700 font-semibold"},Bt={class:"px-6 py-4"},Tt={class:"flex items-center gap-2"},Ut={class:"h-2 flex-1 max-w-xs rounded-full bg-gray-200"},At={class:"text-xs text-gray-500"},Et={key:0},Gt={__name:"Students",setup(Ht){const d=n({total:0,male:0,female:0,by_class:[]}),h=n([]),w=n([]),m=n({exams:[],classes:[],subjects:[]}),k=n(!1),g=n(""),i=n(""),u=n(""),x=n(""),b=n(10);async function N(){try{const l=await fetch(route("api.reports.filters"),{headers:{"X-Requested-With":"XMLHttpRequest"}});l.ok&&(m.value=await l.json())}catch{console.error("Failed to load filters")}}async function S(){k.value=!0,g.value="";try{const l=await fetch(route("api.reports.students"),{headers:{"X-Requested-With":"XMLHttpRequest"}});if(!l.ok)throw new Error("Failed");d.value=await l.json()}catch{g.value="Failed to load students report."}finally{k.value=!1}}async function M(){try{const l=new URLSearchParams;i.value&&l.append("exam_id",i.value),u.value&&l.append("class_name",u.value),x.value&&l.append("subject_id",x.value),l.append("limit",b.value);const e=await fetch(route("api.reports.top-students")+"?"+l.toString(),{headers:{"X-Requested-With":"XMLHttpRequest"}});if(e.ok){const s=await e.json();h.value=s.students||[]}}catch{console.error("Failed to load top students")}}async function F(){try{const l=new URLSearchParams;i.value&&l.append("exam_id",i.value),u.value&&l.append("class_name",u.value);const e=await fetch(route("api.reports.subject-rankings")+"?"+l.toString(),{headers:{"X-Requested-With":"XMLHttpRequest"}});if(e.ok){const s=await e.json();w.value=s.subjects||[]}}catch{console.error("Failed to load subject rankings")}}return q(async()=>{await N(),await S(),await M(),await F()}),L([i,u,x,b],()=>{M(),F()}),(l,e)=>(a(),o(c,null,[R(V(X),{title:"Students Reports"}),R(U,null,{header:j(()=>[...e[4]||(e[4]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Students Reports",-1)])]),default:j(()=>[t("div",A,[g.value?(a(),o("div",E,[B(r(g.value)+" ",1),t("button",{onClick:S,class:"ml-2 rounded border border-rose-300 px-2 py-0.5 text-rose-700 hover:bg-rose-100"}," Retry ")])):f("",!0),t("div",H,[t("div",D,[t("div",P,[t("div",null,[e[5]||(e[5]=t("div",{class:"text-sm font-medium text-blue-600"},"Total Students",-1)),t("div",W,r(d.value.total),1)]),e[6]||(e[6]=t("div",{class:"rounded-full bg-blue-100 p-3"},[t("svg",{class:"h-8 w-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})])],-1))])]),t("div",G,[t("div",$,[t("div",null,[e[7]||(e[7]=t("div",{class:"text-sm font-medium text-green-600"},"Male Students",-1)),t("div",I,r(d.value.male),1)]),e[8]||(e[8]=t("div",{class:"rounded-full bg-green-100 p-3"},[t("svg",{class:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1))])]),t("div",J,[t("div",K,[t("div",null,[e[9]||(e[9]=t("div",{class:"text-sm font-medium text-pink-600"},"Female Students",-1)),t("div",O,r(d.value.female),1)]),e[10]||(e[10]=t("div",{class:"rounded-full bg-pink-100 p-3"},[t("svg",{class:"h-8 w-8 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1))])])]),t("div",Q,[e[18]||(e[18]=t("h3",{class:"mb-4 text-base font-semibold text-gray-800"},"Filters",-1)),t("div",Y,[t("div",null,[e[12]||(e[12]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Exam",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:border-blue-500 focus:ring-blue-500"},[e[11]||(e[11]=t("option",{value:""},"All Exams",-1)),(a(!0),o(c,null,p(m.value.exams,s=>(a(),o("option",{key:s.id,value:s.id},r(s.name),9,Z))),128))],512),[[_,i.value]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Class",-1)),v(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:border-blue-500 focus:ring-blue-500"},[e[13]||(e[13]=t("option",{value:""},"All Classes",-1)),(a(!0),o(c,null,p(m.value.classes,s=>(a(),o("option",{key:s.id,value:s.name},r(s.name),9,tt))),128))],512),[[_,u.value]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Subject",-1)),v(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>x.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:border-blue-500 focus:ring-blue-500"},[e[15]||(e[15]=t("option",{value:""},"All Subjects",-1)),(a(!0),o(c,null,p(m.value.subjects,s=>(a(),o("option",{key:s.id,value:s.id},r(s.name),9,et))),128))],512),[[_,x.value]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Top N",-1)),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),type:"number",min:"5",max:"50",class:"w-full rounded-lg border-gray-300 text-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[T,b.value,void 0,{number:!0}]])])])]),t("div",st,[e[21]||(e[21]=t("div",{class:"border-b bg-gradient-to-r from-yellow-50 to-amber-50 px-6 py-4"},[t("h3",{class:"text-lg font-semibold text-gray-800"},"ðŸ† Top Performing Students")],-1)),t("div",ot,[t("table",at,[e[20]||(e[20]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Rank"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Student Name"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Class"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Avg Marks"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Subjects")])],-1)),t("tbody",lt,[(a(!0),o(c,null,p(h.value,(s,y)=>(a(),o("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[t("td",rt,[y===0?(a(),o("span",nt,"ðŸ¥‡")):y===1?(a(),o("span",dt,"ðŸ¥ˆ")):y===2?(a(),o("span",it,"ðŸ¥‰")):(a(),o("span",ut,r(y+1),1))]),t("td",ct,r(s.name),1),t("td",pt,[t("span",xt,r(s.class_name),1)]),t("td",mt,[t("span",{class:C(["inline-flex items-center rounded-full px-2.5 py-0.5 text-sm font-semibold",s.avg_marks>=80?"bg-green-100 text-green-800":s.avg_marks>=60?"bg-yellow-100 text-yellow-800":"bg-orange-100 text-orange-800"])},r(parseFloat(s.avg_marks).toFixed(1))+"% ",3)]),t("td",gt,r(s.subjects_count),1)]))),128)),h.value.length===0?(a(),o("tr",bt,[...e[19]||(e[19]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-sm text-gray-500"}," No students found ",-1)])])):f("",!0)])])])]),t("div",yt,[e[24]||(e[24]=t("div",{class:"border-b bg-gradient-to-r from-purple-50 to-indigo-50 px-6 py-4"},[t("h3",{class:"text-lg font-semibold text-gray-800"},"ðŸ“Š Subject Performance Rankings")],-1)),t("div",ft,[t("table",vt,[e[23]||(e[23]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Subject"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Avg Marks"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Max"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Min"),t("th",{class:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-gray-700"},"Students")])],-1)),t("tbody",ht,[(a(!0),o(c,null,p(w.value,s=>(a(),o("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[t("td",wt,r(s.name),1),t("td",_t,[t("div",kt,[t("div",St,[t("div",{class:C(["h-2 rounded-full",s.avg_marks>=80?"bg-green-500":s.avg_marks>=60?"bg-yellow-500":"bg-orange-500"]),style:z({width:Math.min(100,s.avg_marks)+"%"})},null,6)]),t("span",Mt,r(parseFloat(s.avg_marks).toFixed(1))+"%",1)])]),t("td",Ft,r(parseFloat(s.max_marks).toFixed(1)),1),t("td",Rt,r(parseFloat(s.min_marks).toFixed(1)),1),t("td",jt,r(s.students_count),1)]))),128)),w.value.length===0?(a(),o("tr",Ct,[...e[22]||(e[22]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-sm text-gray-500"}," No subject data found ",-1)])])):f("",!0)])])])]),t("div",zt,[e[27]||(e[27]=t("div",{class:"border-b bg-gradient-to-r from-teal-50 to-cyan-50 px-6 py-4"},[t("h3",{class:"text-lg font-semibold text-gray-800"},"Student Distribution by Class")],-1)),t("div",Nt,[t("table",qt,[e[26]||(e[26]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left font-semibold text-gray-700"},"Class"),t("th",{class:"px-6 py-3 text-left font-semibold text-gray-700"},"Students"),t("th",{class:"px-6 py-3 text-left font-semibold text-gray-700"},"Distribution")])],-1)),t("tbody",Lt,[(a(!0),o(c,null,p(d.value.by_class,s=>(a(),o("tr",{key:s.class_name,class:"hover:bg-gray-50"},[t("td",Vt,r(s.class_name||"â€”"),1),t("td",Xt,r(s.count),1),t("td",Bt,[t("div",Tt,[t("div",Ut,[t("div",{class:"h-2 rounded-full bg-blue-500",style:z({width:Math.min(100,s.count/d.value.total*100)+"%"})},null,4)]),t("span",At,r((s.count/d.value.total*100).toFixed(1))+"%",1)])])]))),128)),(d.value.by_class||[]).length===0?(a(),o("tr",Et,[...e[25]||(e[25]=[t("td",{colspan:"3",class:"px-6 py-8 text-center text-sm text-gray-500"},"No data.",-1)])])):f("",!0)])])])])])]),_:1})],64))}};export{Gt as default};
